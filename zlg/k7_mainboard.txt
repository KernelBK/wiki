[[k7_mainboard_fpga_source]]
fpga
# 参数打包下载
	终端软件将参数打包成可扩展结构，每一项参数包含其唯一标识及类型信息，最后统一下载，由软核解析并写入特定的寄存器。
1、	参数由ID进行标识，终端软件无需保存寄存器列表，降低版本依赖。
2、	FPGA可对参数进行二次检查，满足要求后，再配置前端，否则向终端软件报错。


# 设备控制
命令/应答 方式
由终端软件生成命令包，FPGA执行完成后返回应答包。	
1、	交互数据区可复用。
2、	易于扩展新命令。
3、	应答可以使用单一中断源返回执行结果。	
1、	引入软核，会消耗FPGA部分资源。
2、	命令解析存在延时。
	
# 数据上传

dsp
（2）	主FPGA将来自各个前端FPGA的数据进行汇总，并进行一些常规处理后将其缓存至DDR3内；
（3）	主FPGA通过事件通知的方式通知DSP有原始数据的到来，DSP通过SRIO读出（或DSP通知FPGA进行推送）原始数据保存至DSP自身的DDR3内；


当测量模式更新时，初始化任务会收到被ISR激活的事件，从而重新创建各个任务、对象以及缓冲区。待全部需要重新创建的内容完成后，DSP会以中断的形式通知PC驱动，驱动收到全部板卡的配置完成通知之后，即可开始同步采样。

每隔一段固定的时间（基本测量模式下为10ms），FPGA会以中断的形式（SramDataReady）通知DSP取走缓存中的原始采样数据。

使用硬件锁相环（PLL）来对输入信号进行倍频，并以此倍频信号作为A/D的采样时钟。这样，不论输入信号的频率为何值，都可以保证单个观测区间所对应的窗内包含整数个输入信号的周期，即同步采样。


